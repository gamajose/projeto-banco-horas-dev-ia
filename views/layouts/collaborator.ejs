<!DOCTYPE html>
<html lang="pt-BR" class="bg-gray-100">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %> - Banco de Horas
    </title>
    <link rel="stylesheet" href="/css/output.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body class="font-sans">

    <div class="container mx-auto max-w-4xl p-4">
        <header class="flex justify-between items-center py-4">
            <div class="text-left">
                <h1 class="text-2xl font-bold text-gray-800">Bom dia, <%= user.first_name || 'Colaborador' %>!</h1>
                <p class="text-sm text-gray-500">
                    <%= new Date().toLocaleDateString('pt-BR', { weekday: 'long' , year: 'numeric' , month: 'long' ,
                        day: 'numeric' }) %>
                </p>
            </div>
            <button id="open-menu-btn" class="text-gray-700">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </header>

        <nav class="my-6">
            <ul class="grid grid-cols-4 gap-2 bg-white rounded-full shadow-md p-2">
                <li><a href="/meu-perfil"
                        class="nav-item flex justify-center text-center py-3 px-4 rounded-full font-semibold text-sm transition-colors duration-200 <%= activePage === 'home' ? 'active' : 'text-gray-800 hover:bg-gray-200' %>">Home</a>
                </li>
                <li><a href="/profile/gerenciar"
                        class="nav-item flex justify-center text-center py-3 px-4 rounded-full font-semibold text-sm transition-colors duration-200 <%= activePage === 'gerenciar' ? 'active' : 'text-gray-800 hover:bg-gray-200' %>">Gerenciar Horas</a></li>
                <li><a href="/profile/relatorio"
                        class="nav-item flex justify-center text-center py-3 px-4 rounded-full font-semibold text-sm transition-colors duration-200 <%= activePage === 'relatorio' ? 'active' : 'text-gray-800 hover:bg-gray-200' %>">Relatório</a>
                </li>
                <li><button id="btn-sugestao-colab"
                        class="nav-item w-full flex justify-center text-center py-3 px-4 rounded-full font-semibold text-sm text-gray-800 hover:bg-gray-200 transition-colors duration-200">Sugestão</button>
                </li>
            </ul>
        </nav>
        <main>
            <%- body %>
        </main>
    </div>

    <div id="options-modal"
        class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden z-50 transition-opacity ease-in-out duration-300">
        <div id="modal-content-wrapper"
            class="relative top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 p-6 border w-full max-w-sm shadow-lg rounded-2xl bg-white transition-transform ease-in-out duration-300 transform scale-95">
            <div class="flex justify-between items-center pb-3 border-b border-gray-200">
                <h3 class="text-2xl font-bold text-gray-800">Opções</h3>
                <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>
            </div>
            <div class="mt-4">
                <nav class="space-y-2">
                    <a href="/profile/editar"
                        class="block p-3 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                        <i class="fas fa-user-edit mr-3 text-gray-500"></i>
                        Editar Perfil
                    </a>
                    <a href="/auth/logout"
                        class="block p-3 rounded-lg text-red-600 hover:bg-red-50 transition-colors duration-200">
                        <i class="fas fa-sign-out-alt mr-3 text-red-500"></i>
                        Sair (Logout)
                    </a>
                </nav>
            </div>
        </div>
    </div>
    
    <%- include('../partials/modal-sugestao', { userProfile: locals.userProfile || {} }) %>


</body>

</html>

<script>  
    document.addEventListener('DOMContentLoaded', () => {
        const openMenuBtn = document.getElementById('open-menu-btn');
        const modal = document.getElementById('options-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const modalContent = document.getElementById('modal-content-wrapper');
        const btnSugestaoColab = document.getElementById('btn-sugestao-colab');
        const modalSugestao = document.getElementById('modal-sugestao');
        const closeModalSugestaoBtn = document.getElementById('modal-sugestao-close');


        function openModal(modalEl, contentEl) {
            modalEl.classList.remove('hidden');
            setTimeout(() => {
                modalEl.classList.add('opacity-100');
                if (contentEl) contentEl.classList.remove('scale-95');
            }, 10);
        }

        function closeModal(modalEl, contentEl) {
            modalEl.classList.remove('opacity-100');
            if (contentEl) contentEl.classList.add('scale-95');
            setTimeout(() => {
                modalEl.classList.add('hidden');
            }, 300);
        }

        if (openMenuBtn && modal && closeModalBtn) {
            openMenuBtn.addEventListener('click', () => openModal(modal, modalContent));
            closeModalBtn.addEventListener('click', () => closeModal(modal, modalContent));
            modal.addEventListener('click', (e) => {
                if (e.target.id === 'options-modal') {
                    closeModal(modal, modalContent);
                }
            });
        }

        // Lógica para abrir e fechar o modal de sugestão
        if (btnSugestaoColab && modalSugestao) {
            btnSugestaoColab.addEventListener('click', () => openModal(modalSugestao));
        }
        if (closeModalSugestaoBtn && modalSugestao) {
            closeModalSugestaoBtn.addEventListener('click', () => closeModal(modalSugestao));
             modalSugestao.addEventListener('click', (e) => {
                if (e.target.id === 'modal-sugestao') {
                    closeModal(modalSugestao);
                }
            });
        }
    });
</script>